(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{266:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return i})),t.d(n,"rightToc",(function(){return p})),t.d(n,"default",(function(){return s}));var a=t(1),o=t(9),r=(t(0),t(311)),i={id:"ecosystem-vue",title:"single-spa-vue",sidebar_label:"Vue"},p=[{value:"Example",id:"example",children:[]},{value:"Live demo",id:"live-demo",children:[]},{value:"Installation",id:"installation",children:[{value:"Vue CLI",id:"vue-cli",children:[]},{value:"Without Vue CLI",id:"without-vue-cli",children:[]}]},{value:"Usage",id:"usage",children:[{value:"Vue 2",id:"vue-2",children:[]},{value:"Vue 3",id:"vue-3",children:[]}]},{value:"Custom props",id:"custom-props",children:[]},{value:"Shared dependencies",id:"shared-dependencies",children:[{value:"Shared deps with Vue CLI",id:"shared-deps-with-vue-cli",children:[]},{value:"Shared deps without Vue CLI",id:"shared-deps-without-vue-cli",children:[]}]},{value:"Options",id:"options",children:[]},{value:"Custom Props",id:"custom-props-1",children:[]},{value:"Parcels",id:"parcels",children:[{value:"Creating a parcel",id:"creating-a-parcel",children:[]},{value:"Rendering a parcel",id:"rendering-a-parcel",children:[]}]}],l={rightToc:p},c="wrapper";function s(e){var n=e.components,t=Object(o.a)(e,["components"]);return Object(r.b)(c,Object(a.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(r.b)("p",null,"single-spa-vue is a helper library that helps implement ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"configuration#registering-applications"}),"single-spa registered application")," ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/building-applications#registered-application-lifecycle"}),"lifecycle functions")," (bootstrap, mount and unmount) for use with ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://vuejs.org/"}),"Vue.js"),". Check out the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/single-spa/single-spa-vue"}),"single-spa-vue github"),"."),Object(r.b)("h2",{id:"example"},"Example"),Object(r.b)("p",null,"For a full example, see ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/vue-microfrontends"}),"vue-microfrontends"),"."),Object(r.b)("h2",{id:"live-demo"},"Live demo"),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://coexisting-vue-microfrontends.surge.sh"}),"https://coexisting-vue-microfrontends.surge.sh")),Object(r.b)("h2",{id:"installation"},"Installation"),Object(r.b)("h3",{id:"vue-cli"},"Vue CLI"),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/single-spa/vue-cli-plugin-single-spa"}),"vue-cli-plugin-single-spa")," will get everything set up."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"vue add single-spa\n")),Object(r.b)("p",null,"The CLI Plugin does the following for you:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Modify your webpack config so that your project works as a single-spa application or parcel."),Object(r.b)("li",{parentName:"ol"},"Install ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/single-spa/single-spa-vue"}),"single-spa-vue"),"."),Object(r.b)("li",{parentName:"ol"},"Modify your ",Object(r.b)("inlineCode",{parentName:"li"},"main.js")," or ",Object(r.b)("inlineCode",{parentName:"li"},"main.ts")," file so that your project works as a single-spa application or parcel."),Object(r.b)("li",{parentName:"ol"},"Add a ",Object(r.b)("inlineCode",{parentName:"li"},"set-public-path.js")," that will use ",Object(r.b)("inlineCode",{parentName:"li"},"systemjs-webpack-interop")," in order to set the public path of your application.")),Object(r.b)("h3",{id:"without-vue-cli"},"Without Vue CLI"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"npm install --save single-spa-vue\n")),Object(r.b)("p",null,"Alternatively, you can use single-spa-vue by adding ",Object(r.b)("inlineCode",{parentName:"p"},'<script src="https://unpkg.com/single-spa-vue"><\/script>')," to your HTML file and\naccessing the ",Object(r.b)("inlineCode",{parentName:"p"},"singleSpaVue")," global variable."),Object(r.b)("h2",{id:"usage"},"Usage"),Object(r.b)("p",null,"Install ",Object(r.b)("inlineCode",{parentName:"p"},"systemjs-webpack-interop")," if you have not already done so."),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"npm install systemjs-webpack-interop -S")),Object(r.b)("p",null,"Create a file at the same level as your ",Object(r.b)("inlineCode",{parentName:"p"},"main.js/ts")," called ",Object(r.b)("inlineCode",{parentName:"p"},"set-public-path.js")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"import { setPublicPath } from 'systemjs-webpack-interop';\n\nsetPublicPath('appName');\n")),Object(r.b)("p",null,"Note that if you are using the Vue CLI Plugin, your ",Object(r.b)("inlineCode",{parentName:"p"},"main.ts")," or ",Object(r.b)("inlineCode",{parentName:"p"},"main.js")," file will be updated with this code automatically and the ",Object(r.b)("inlineCode",{parentName:"p"},"set-public-path.js")," file\nwill automatically be created with the app name being your package.json's name property."),Object(r.b)("p",null,"If you want to deal with your Vue instance, you can modify the mount method by following this. mount method will return Promise with Vue instance after ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/single-spa/single-spa-vue/releases/tag/v1.6.0"}),"v1.6.0"),"."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const vueLifecycles = singleSpaVue({...})\n\nexport const mount = props => vueLifecycles.mount(props).then(instance => {\n  // do what you want with the Vue instance\n  ...\n})\n")),Object(r.b)("h3",{id:"vue-2"},"Vue 2"),Object(r.b)("p",null,"For Vue 2, change your application's entry file to be the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"import './set-public-path';\nimport Vue from 'vue';\nimport App from './App.vue';\nimport router from './router';\nimport singleSpaVue from 'single-spa-vue';\n\nconst vueLifecycles = singleSpaVue({\n  Vue,\n  appOptions: {\n    render(h) {\n      return h(App);\n    },\n    router,\n  },\n});\n\nexport const bootstrap = vueLifecycles.bootstrap;\nexport const mount = vueLifecycles.mount;\nexport const unmount = vueLifecycles.unmount;\n")),Object(r.b)("h3",{id:"vue-3"},"Vue 3"),Object(r.b)("p",null,"For Vue 3, change your application's entry file to be the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"import './set-public-path';\nimport { h, createApp } from 'vue';\nimport singleSpaVue from '../lib/single-spa-vue.js';\nimport router from './router';\nimport App from './App.vue';\n\nconst vueLifecycles = singleSpaVue({\n  createApp,\n  appOptions: {\n    render() {\n      return h(App, {\n        // single-spa props are available on the \"this\" object. Forward them to your component as needed.\n        // https://single-spa.js.org/docs/building-applications#lifecyle-props\n        name: this.name,\n        mountParcel: this.mountParcel,\n        singleSpa: this.singleSpa,\n      });\n    },\n  },\n  handleInstance: (app) => {\n    app.use(router);\n  }\n});\n\nexport const bootstrap = vueLifecycles.bootstrap;\nexport const mount = vueLifecycles.mount;\nexport const unmount = vueLifecycles.unmount;\n")),Object(r.b)("h2",{id:"custom-props"},"Custom props"),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/building-applications/#lifecycle-props"}),"Single-spa custom props")," can be passed to your root component like so:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"// main.js\nconst vueLifecycles = singleSpaVue({\n  Vue,\n  appOptions: {\n    render(h) {\n      return h(App, {\n        mountParcel: this.mountParcel,\n        otherProp: this.otherProp,\n      });\n    },\n    router,\n  },\n});\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-vue"}),"// App.vue\n<template>\n  <button>{{ otherProp }}</button>\n</template>\n<script>\nexport default {\n  props: ['mountParcel', 'otherProp'],\n}\n<\/script>\n")),Object(r.b)("h2",{id:"shared-dependencies"},"Shared dependencies"),Object(r.b)("p",null,"For performance, it is best to share a single version and instance of Vue, Vue Router, and other large libraries."),Object(r.b)("p",null,"To do this, add your shared dependencies as ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://webpack.js.org/configuration/externals"}),"webpack externals"),". Then you use\nan in-browser module loader such as ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/systemjs/systemjs"}),"systemjs")," to provide those shared dependencies\nto each of the single-spa applications. Adding ",Object(r.b)("inlineCode",{parentName:"p"},"vue")," and other libraries to your\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://single-spa-playground.org/playground/import-map"}),"import map"),". For an example import map that is doing this,\ncheckout ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/joeldenning/coexisting-vue-microfrontends/blob/master/root-html-file/index.html"}),"coexisting-vue-microfrontends' index.html file"),"."),Object(r.b)("p",null,"Sharing a single instance of Vue and other common libraries is highly recommended. See the\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://single-spa.js.org/docs/faq.html#is-there-a-recommended-setup"}),"recommended setup for single-spa")," for more details on why."),Object(r.b)("h3",{id:"shared-deps-with-vue-cli"},"Shared deps with Vue CLI"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"// vue.config.js\nmodule.exports = {\n  chainWebpack: config => {\n    config.externals(['vue', 'vue-router']);\n  },\n};\n")),Object(r.b)("h3",{id:"shared-deps-without-vue-cli"},"Shared deps without Vue CLI"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"// webpack.config.js\nmodule.exports = {\n  externals: ['vue', 'vue-router'],\n};\n")),Object(r.b)("h2",{id:"options"},"Options"),Object(r.b)("p",null,"All options are passed to single-spa-vue via the ",Object(r.b)("inlineCode",{parentName:"p"},"opts")," parameter when calling ",Object(r.b)("inlineCode",{parentName:"p"},"singleSpaVue(opts)"),". The following options are available:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Vue"),": (required) The main Vue object, which is generally either exposed onto the window or is available via ",Object(r.b)("inlineCode",{parentName:"li"},"require('vue')")," ",Object(r.b)("inlineCode",{parentName:"li"},"import Vue from 'vue'"),"."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"appOptions"),": (required) An object which will be used to instantiate your Vue.js application. ",Object(r.b)("inlineCode",{parentName:"li"},"appOptions")," will pass directly through to ",Object(r.b)("inlineCode",{parentName:"li"},"new Vue(appOptions)"),". Note that if you do not provide an ",Object(r.b)("inlineCode",{parentName:"li"},"el")," to appOptions, that a div will be created and appended to the DOM as a default container for your Vue application."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"loadRootComponent"),": (optional and replaces ",Object(r.b)("inlineCode",{parentName:"li"},"appOptions.render"),") A promise that resolves with your root component. This is useful for lazy loading."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"handleInstance"),": (optional) A method can be used to handle Vue instance. Vue 3 brings ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://v3.vuejs.org/guide/migration/global-api.html#a-new-global-api-createapp"}),"new instance API"),", and you can access ",Object(r.b)("em",{parentName:"li"},"the app instance")," from this, like ",Object(r.b)("inlineCode",{parentName:"li"},"handleInstance: (app) => app.use(router)"),". For Vue 2 users, a ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://vuejs.org/v2/guide/instance.html"}),"Vue instance")," can be accessed.")),Object(r.b)("p",null,"To configure which dom element the single-spa application is mounted to, use ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://vuejs.org/v2/api/#el"}),"appOptions.el"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const vueLifecycles = singleSpaVue({\n  Vue,\n  appOptions: {\n    render: h => h(App),\n    el: '#a-special-container',\n  },\n});\n")),Object(r.b)("h2",{id:"custom-props-1"},"Custom Props"),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/building-applications.html#custom-props"}),"single-spa custom props")," are added to your App component as\n",Object(r.b)("inlineCode",{parentName:"p"},"appOptions.data"),", and are accessible via ",Object(r.b)("inlineCode",{parentName:"p"},"vm.$data"),". See ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://vuejs.org/v2/api/#data"}),"this Vue documentation"),"\nfor more information on ",Object(r.b)("inlineCode",{parentName:"p"},"appOptions.data"),"."),Object(r.b)("h2",{id:"parcels"},"Parcels"),Object(r.b)("h3",{id:"creating-a-parcel"},"Creating a parcel"),Object(r.b)("p",null,"A parcel config is an object that represents a component implemented in Vue, React, Angular, or any other framework."),Object(r.b)("p",null,"To create a VueJS single-spa parcel config object, simply omit the ",Object(r.b)("inlineCode",{parentName:"p"},"el")," option from your appOptions, since the dom element will be specified by the user of the Parcel. Every other\noption should be provided exactly the same as in the example above."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const parcelConfig = singleSpaVue({...});\n")),Object(r.b)("h3",{id:"rendering-a-parcel"},"Rendering a parcel"),Object(r.b)("p",null,"To render a parcel config object in Vue, you can use single-spa-vue's ",Object(r.b)("inlineCode",{parentName:"p"},"Parcel")," component:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-vue"}),'<template>\n  <Parcel\n    v-on:parcelMounted="parcelMounted()"\n    v-on:parcelUpdated="parcelUpdated()"\n    :config="parcelConfig"\n    :mountParcel="mountParcel"\n    :wrapWith="wrapWith"\n    :wrapClass="wrapClass"\n    :wrapStyle="wrapStyle"\n    :parcelProps="getParcelProps()"\n  />\n</template>\n\n<script>\n// For old versions of webpack\nimport Parcel from \'single-spa-vue/dist/esm/parcel\'\n// For new versions of webpack\nimport Parcel from \'single-spa-vue/parcel\'\n\nimport { mountRootParcel } from \'single-spa\'\n\nconst Widget =\n\nexport default {\n  components: {\n    Parcel\n  },\n  data() {\n    return {\n      /*\n        parcelConfig (object, required)\n\n        The parcelConfig is an object, or a promise that resolves with a parcel config object.\n        The object can originate from within the current project, or from a different\n        microfrontend via cross microfrontend imports. It can represent a Vue component,\n        or a React / Angular component.\n        https://single-spa.js.org/docs/recommended-setup#cross-microfrontend-imports\n\n        Vanilla js object:\n        parcelConfig: {\n          async mount(props) {},\n          async unmount(props) {}\n        }\n\n        // React component\n        parcelConfig: singleSpaReact({...})\n\n        // cross microfrontend import is shown below\n      */\n      parcelConfig: System.import(\'@org/other-microfrontend\').then(ns => ns.Widget),\n\n\n      /*\n        mountParcel (function, required)\n\n        The mountParcel function can be either the current Vue application\'s mountParcel prop or\n        the globally available mountRootParcel function. More info at\n        http://localhost:3000/docs/parcels-api#mountparcel\n      */\n      mountParcel: mountRootParcel,\n\n      /*\n        wrapWith (string, optional)\n\n        The wrapWith string determines what kind of dom element will be provided to the parcel.\n        Defaults to \'div\'\n      */\n      wrapWith: \'div\'\n\n      /*\n        wrapClass (string, optional)\n\n        The wrapClass string is applied to as the CSS class for the dom element that is provided to the parcel\n      */\n      wrapClass: "bg-red"\n\n      /*\n        wrapStyle (object, optional)\n\n        The wrapStyle object is applied to the dom element container for the parcel as CSS styles\n      */\n      wrapStyle: {\n        outline: \'1px solid red\'\n      },\n    }\n  },\n  methods: {\n    // These are the props passed into the parcel\n    getParcelProps() {\n      return {\n        text: `Hello world`\n      }\n    },\n    // Parcels mount asynchronously, so this will be called once the parcel finishes mounting\n    parcelMounted() {\n      console.log("parcel mounted");\n    },\n    parcelUpdated() {\n      console.log("parcel updated");\n    }\n  }\n}\n<\/script>\n')))}s.isMDXComponent=!0},311:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return u}));var a=t(0),o=t.n(a),r=o.a.createContext({}),i=function(e){var n=o.a.useContext(r),t=n;return e&&(t="function"==typeof e?e(n):Object.assign({},n,e)),t},p=function(e){var n=i(e.components);return o.a.createElement(r.Provider,{value:n},e.children)};var l="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return o.a.createElement(o.a.Fragment,{},n)}},s=Object(a.forwardRef)((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,l=function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===n.indexOf(a)&&(t[a]=e[a]);return t}(e,["components","mdxType","originalType","parentName"]),s=i(t),u=a,b=s[p+"."+u]||s[u]||c[u]||r;return t?o.a.createElement(b,Object.assign({},{ref:n},l,{components:t})):o.a.createElement(b,Object.assign({},{ref:n},l))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,i=new Array(r);i[0]=s;var p={};for(var c in n)hasOwnProperty.call(n,c)&&(p[c]=n[c]);p.originalType=e,p[l]="string"==typeof e?e:a,i[1]=p;for(var u=2;u<r;u++)i[u]=t[u];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,t)}s.displayName="MDXCreateElement"}}]);